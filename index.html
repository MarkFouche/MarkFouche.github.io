<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
        <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    </head>
    <body>
        <div id="image-map" style="height: 600px"></div>
        <canvas id="html5canvas"></canvas>
        <img id="test-image" src="images/Estate/maptest.jpg" /></td>

        <script>
            "use strict";
            
            var canvas = document.getElementById("html5canvas");
            
            function convertImageToCanvas(image) {
                canvas.width = image.width;
                canvas.height = image.height;
                var drawSurface = canvas.getContext("2d");
                drawSurface.drawImage(image, 0, 0);
            }

            function convertCanvasToImage(canvas) {
                var image = new Image();
                image.src = canvas.toDataURL();
                console.log(canvas.toDataURL());
                return image;
            }

            var tempImage = document.getElementById("test-image");
            console.log(document.getElementById("test-image").src);
            console.log(tempImage.src);
            convertImageToCanvas(tempImage);
            var myImage = convertCanvasToImage(canvas);

            // create the image map
            var map = L.map('image-map', {
                minZoom: 1,
                maxZoom: 4,
                center: [0, 0],
                zoom: 1,
                crs: L.CRS.Simple
            });

            // dimensions of the image
            var w = 824,
                h = 453,
                url = myImage.src;

            // calculate the edges of the image, in coordinate space
            var southWest = map.unproject([0, h], map.getMaxZoom() - 1);
            var northEast = map.unproject([w, 0], map.getMaxZoom() - 1);
            var bounds = new L.LatLngBounds(southWest, northEast);

            // add the image overlay,
            // so that it covers the entire map
            L.imageOverlay(url, bounds).addTo(map);

            // tell leaflet that the map is exactly as big as the image
            map.setMaxBounds(bounds); 
        </script>
    </body>
</html>
